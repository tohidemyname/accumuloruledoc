<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_152) on Mon Mar 04 14:05:25 CST 2019 -->
<title>StatusMaker</title>
<meta name="date" content="2019-03-04">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="StatusMaker";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/accumulo/master/replication/SequentialWorkAssigner.html" title="class in org.apache.accumulo.master.replication"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/accumulo/master/replication/UnorderedWorkAssigner.html" title="class in org.apache.accumulo.master.replication"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/accumulo/master/replication/StatusMaker.html" target="_top">Frames</a></li>
<li><a href="StatusMaker.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.accumulo.master.replication</div>
<h2 title="Class StatusMaker" class="title">Class StatusMaker</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.accumulo.master.replication.StatusMaker</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">StatusMaker</span>
extends java.lang.Object</pre>
<div class="block">Reads replication records from the metadata table and creates status records in the replication
 table. Deletes the record from the metadata table when it's closed.</div>
</li>
</ul>
</div>
Shall be called with <a href="../../../../../org/apache/accumulo/core/client/Connector.html"><code>Connector</code></a>, <a href="../../../../../org/apache/accumulo/server/fs/VolumeManager.html"><code>VolumeManager</code></a>. 
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/apache/accumulo/master/replication/StatusMaker.html#StatusMaker-org.apache.accumulo.core.client.Connector-org.apache.accumulo.server.fs.VolumeManager-">StatusMaker</a></span>(<a href="../../../../../org/apache/accumulo/core/client/Connector.html" title="class in org.apache.accumulo.core.client">Connector</a>&nbsp;conn,
           <a href="../../../../../org/apache/accumulo/server/fs/VolumeManager.html" title="interface in org.apache.accumulo.server.fs">VolumeManager</a>&nbsp;fs)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/accumulo/master/replication/StatusMaker.html#addOrderRecord-Text-java.lang.String-org.apache.accumulo.server.replication.proto.Replication.Status-org.apache.accumulo.core.data.Value-">addOrderRecord</a></span>(Text&nbsp;file,
              java.lang.String&nbsp;tableId,
              <a href="../../../../../org/apache/accumulo/server/replication/proto/Replication.Status.html" title="class in org.apache.accumulo.server.replication.proto">Replication.Status</a>&nbsp;stat,
              <a href="../../../../../org/apache/accumulo/core/data/Value.html" title="class in org.apache.accumulo.core.data">Value</a>&nbsp;value)</code>
<div class="block">Create a record to track when the file was closed to ensure that replication preference is
 given to files that have been closed the longest and allow the work assigner to try to
 replicate in order that data was ingested (avoid replay in different order)</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/accumulo/master/replication/StatusMaker.html#addStatusRecord-Text-java.lang.String-org.apache.accumulo.core.data.Value-">addStatusRecord</a></span>(Text&nbsp;file,
               java.lang.String&nbsp;tableId,
               <a href="../../../../../org/apache/accumulo/core/data/Value.html" title="class in org.apache.accumulo.core.data">Value</a>&nbsp;v)</code>
<div class="block">Create a status record in the replication table</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/accumulo/master/replication/StatusMaker.html#deleteStatusRecord-org.apache.accumulo.core.data.Key-">deleteStatusRecord</a></span>(<a href="../../../../../org/apache/accumulo/core/data/Key.html" title="class in org.apache.accumulo.core.data">Key</a>&nbsp;k)</code>
<div class="block">Because there is only one active Master, and thus one active StatusMaker, the only safe time
 that we can issue the delete for a Status which is closed is immediately after writing it to
 the replication table.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/accumulo/master/replication/StatusMaker.html#run--">run</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/accumulo/master/replication/StatusMaker.html#setBatchWriter-org.apache.accumulo.core.client.BatchWriter-">setBatchWriter</a></span>(<a href="../../../../../org/apache/accumulo/core/client/BatchWriter.html" title="interface in org.apache.accumulo.core.client">BatchWriter</a>&nbsp;bw)</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/accumulo/master/replication/StatusMaker.html#setSourceTableName-java.lang.String-">setSourceTableName</a></span>(java.lang.String&nbsp;table)</code>
<div class="block">Not for public use -- visible only for testing</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="StatusMaker-org.apache.accumulo.core.client.Connector-org.apache.accumulo.server.fs.VolumeManager-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>StatusMaker</h4>
<pre>public&nbsp;StatusMaker(<a href="../../../../../org/apache/accumulo/core/client/Connector.html" title="class in org.apache.accumulo.core.client">Connector</a>&nbsp;conn,
                   <a href="../../../../../org/apache/accumulo/server/fs/VolumeManager.html" title="interface in org.apache.accumulo.server.fs">VolumeManager</a>&nbsp;fs)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setSourceTableName-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setSourceTableName</h4>
<pre>public&nbsp;void&nbsp;setSourceTableName(java.lang.String&nbsp;table)</pre>
<div class="block">Not for public use -- visible only for testing
 <p>
 Used to read records from a table other than 'metadata'</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>table</code> - The table to read from</dd>
</dl>
</li>
</ul>
<a name="run--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;void&nbsp;run()</pre>
</li>
</ul>
<a name="setBatchWriter-org.apache.accumulo.core.client.BatchWriter-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setBatchWriter</h4>
<pre>protected&nbsp;void&nbsp;setBatchWriter(<a href="../../../../../org/apache/accumulo/core/client/BatchWriter.html" title="interface in org.apache.accumulo.core.client">BatchWriter</a>&nbsp;bw)</pre>
</li>
</ul>
<a name="addStatusRecord-Text-java.lang.String-org.apache.accumulo.core.data.Value-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addStatusRecord</h4>
<pre>protected&nbsp;boolean&nbsp;addStatusRecord(Text&nbsp;file,
                                  java.lang.String&nbsp;tableId,
                                  <a href="../../../../../org/apache/accumulo/core/data/Value.html" title="class in org.apache.accumulo.core.data">Value</a>&nbsp;v)</pre>
<div class="block">Create a status record in the replication table</div>
</li>
</ul>
<a name="addOrderRecord-Text-java.lang.String-org.apache.accumulo.server.replication.proto.Replication.Status-org.apache.accumulo.core.data.Value-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addOrderRecord</h4>
<pre>protected&nbsp;boolean&nbsp;addOrderRecord(Text&nbsp;file,
                                 java.lang.String&nbsp;tableId,
                                 <a href="../../../../../org/apache/accumulo/server/replication/proto/Replication.Status.html" title="class in org.apache.accumulo.server.replication.proto">Replication.Status</a>&nbsp;stat,
                                 <a href="../../../../../org/apache/accumulo/core/data/Value.html" title="class in org.apache.accumulo.core.data">Value</a>&nbsp;value)</pre>
<div class="block">Create a record to track when the file was closed to ensure that replication preference is
 given to files that have been closed the longest and allow the work assigner to try to
 replicate in order that data was ingested (avoid replay in different order)</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>file</code> - File being replicated</dd>
<dd><code>tableId</code> - Table ID the file was used by</dd>
<dd><code>stat</code> - Status msg</dd>
<dd><code>value</code> - Serialized version of the Status msg</dd>
</dl>
</li>
</ul>
<a name="deleteStatusRecord-org.apache.accumulo.core.data.Key-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>deleteStatusRecord</h4>
<pre>protected&nbsp;void&nbsp;deleteStatusRecord(<a href="../../../../../org/apache/accumulo/core/data/Key.html" title="class in org.apache.accumulo.core.data">Key</a>&nbsp;k)</pre>
<div class="block">Because there is only one active Master, and thus one active StatusMaker, the only safe time
 that we can issue the delete for a Status which is closed is immediately after writing it to
 the replication table.
 <p>
 If we try to defer and delete these entries in another thread/process, we will have no
 assurance that the Status message was propagated to the replication table. It is easiest, in
 terms of concurrency, to do this all in one step.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>k</code> - The Key to delete</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/accumulo/master/replication/SequentialWorkAssigner.html" title="class in org.apache.accumulo.master.replication"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/accumulo/master/replication/UnorderedWorkAssigner.html" title="class in org.apache.accumulo.master.replication"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/accumulo/master/replication/StatusMaker.html" target="_top">Frames</a></li>
<li><a href="StatusMaker.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
